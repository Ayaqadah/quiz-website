<!DOCTYPE html>
<html>
<head>
<title>Quiz ðŸŒ¿</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
body {
    font-family: "Poppins", sans-serif;
    background: linear-gradient(135deg, #f3f7f4, #e1ece4);
    padding: 40px 15px;
    max-width: 900px;
    margin: auto;
    color: #2F3E34;
    animation: fadeIn 0.6s ease-out;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* Main Card */
#quizBox {
    background: white;
    padding: 35px;
    border-radius: 25px;
    box-shadow: 0px 8px 25px rgba(0,0,0,0.07);
    width: 100%;
}

/* Titles */
h2 {
    color: #7AA78B;
    font-weight: 600;
    margin-bottom: 8px;
}

#moduleTitle {
    margin-bottom: 20px;
    font-size: 20px;
}

/* Progress Bar */
#progressContainer {
    width:100%;
    background:#e5efe7;
    border-radius:20px;
    height:18px;
    margin-bottom:20px;
    overflow:hidden;
}

#progressBar {
    height:100%;
    width:0%;
    background:#8EB897;
    border-radius:20px;
    transition:0.4s;
}

/* Timer */
#timer {
    text-align:right;
    color:#7AA78B;
    font-weight:600;
    display:none;
    font-size: 20px;
}

/* Question text */
#questionText {
    font-size: 20px;
    margin-bottom: 15px;
}

/* Answer options */
.answer {
    background: #F2F5F1;
    padding: 14px 18px;
    border-radius: 15px;
    margin: 10px 0;
    cursor: pointer;
    transition: 0.25s;
    border: 1px solid #DCE7D7;
    font-size: 17px;
}

.answer:hover {
    background: #E7F0E4;
}

.correct {
    background: #CFF5D1 !important;
    border: 2px solid #4CAF50;
}

.wrong {
    background: #F5D3D3 !important;
    border: 2px solid #E15858;
}

.disabled {
    pointer-events: none;
    opacity: 0.7;
}

/* Navigation buttons */
button {
    padding: 12px 30px;
    background: #8EB897;
    color: white;
    border: none;
    border-radius: 18px;
    font-size: 17px;
    cursor: pointer;
    transition: 0.3s;
}

button:hover {
    background: #7AA78B;
}

#backBtn {
    background: #A6C8B2;
}

#backBtn:hover {
    background: #95B7A2;
}

/* Empty state */
.empty-message {
    padding: 25px;
    text-align: center;
    color: #6b7c6f;
    font-size: 18px;
}
</style>
</head>

<body>

<div id="quizBox">

    <!-- Progress bar -->
    <div id="progressContainer">
        <div id="progressBar"></div>
    </div>

    <!-- Timer (hidden unless exam mode) -->
    <h2 id="timer">Time Left: 05:00</h2>

    <h2 id="courseTitle"></h2>
    <h3 id="moduleTitle"></h3>

    <h2 id="questionNumber"></h2>
    <p id="questionText"></p>

    <div id="answers"></div>

    <div style="display:flex; justify-content:space-between; margin-top:25px;">
        <button id="backBtn" onclick="prevQuestion()" style="display:none;">â¬… Back</button>
        <button id="nextBtn" onclick="nextQuestion()">Next âžœ</button>
    </div>
</div>

<script>
/* ----------------------------
Load saved course/module info
---------------------------- */
let course = localStorage.getItem("selectedCourse");
let moduleNum = localStorage.getItem("selectedModule");
let examMode = localStorage.getItem("examMode");

if (!course) {
    // If somehow the course isn't set, send user back to courses
    document.getElementById("quizBox").innerHTML = `
      <div class="empty-message">
        No course selected. <br><br>
        <button onclick="location.href='courses.html'">Back to Courses</button>
      </div>`;
    throw new Error("No course selected");
}

document.getElementById("courseTitle").innerText = course;

/* -----------------------------
QUESTION BANK (correctly defined)
---------------------------- */
let allQuestions = {
  "Machine Learning": {
    1: [
      {
        question: "How does Arthur Samuel define Machine Learning?",
        options: [
          "A computer's ability to learn through trial and error",
          "The ability to learn without being explicitly programmed",
          "Learning from a set of labeled data points",
          "Using statistical models to predict outcomes"
        ],
        answer: 1
      },
      {
        question: "According to Tom Mitchell, when can a computer program be said to learn from experience?",
        options: [
          "When it can generalize from one task to another",
          "When it improves performance on task T after experience E, as measured by performance measure P",
          "When it can memorize data sets",
          "When it can classify data without supervision"
        ],
        answer: 1
      },
      {
        question: "In traditional programming, how would you typically write a spam filter?",
        options: [
          "By analyzing a dataset of spam messages",
          "By creating detection algorithms for specific patterns like words or phrases",
          "By using reinforcement learning techniques",
          "By running a pre-trained algorithm"
        ],
        answer: 1
      },
      {
        question: "How does a spam filter based on Machine Learning detect spam?",
        options: [
          "By learning which words and phrases are predictors of spam through historical examples",
          "By memorizing past emails",
          "By using a pre-programmed rule-based system",
          "By randomly flagging emails"
        ],
        answer: 0
      },
      {
        question: "What is an additional benefit of Machine Learning beyond filtering spam?",
        options: [
          "It can help humans discover patterns in large datasets that were not previously apparent",
          "It replaces the need for human intuition in decision-making",
          "It eliminates the need for supervision in data analysis",
          "It can only handle specific, well-known problems"
        ],
        answer: 0
      },
      {
        question: "What does supervised learning involve?",
        options: [
          "Using labeled training data to learn from historical examples",
          "Classifying data without any labels",
          "Building an algorithm without training data",
          "Comparing new data points to old ones"
        ],
        answer: 0
      },
      {
        question: "Which of the following is an example of a supervised learning task?",
        options: [
          "Clustering data into groups",
          "Predicting the price of a car based on its mileage, brand, and age",
          "Reducing the dimensionality of a dataset",
          "Discovering patterns in unlabeled data"
        ],
        answer: 1
      },
      {
        question: "Which of the following is a task commonly associated with supervised learning?",
        options: ["Clustering", "Classification", "Dimensionality reduction", "Data mining"],
        answer: 1
      },
      {
        question: "Predicting a numeric value like car price is an example of:",
        options: ["Classification", "Clustering", "Regression", "Dimensionality reduction"],
        answer: 2
      },
      {
        question: "Which of the following are examples of supervised learning algorithms?",
        options: ["K-means and DBSCAN", "Neural networks and Decision Trees", "Association rule learning", "Autoencoders"],
        answer: 1
      },
      {
        question: "What distinguishes unsupervised learning from supervised learning?",
        options: [
          "The training data in unsupervised learning is unlabeled",
          "Unsupervised learning requires more training data",
          "Unsupervised learning algorithms always outperform supervised learning",
          "Unsupervised learning focuses on regression tasks"
        ],
        answer: 0
      },
      {
        question: "Which algorithm is used in unsupervised learning?",
        options: ["K-means", "Logistic regression", "Neural networks", "Random forests"],
        answer: 0
      },
      {
        question: "What is the goal of clustering?",
        options: [
          "To discover groups of related observations within the data",
          "To predict numeric values",
          "To classify data into predefined categories",
          "To reduce dimensionality"
        ],
        answer: 0
      },
      {
        question: "Which algorithms can be used for anomaly detection?",
        options: ["One-class SVM and Isolation Forest", "KNN and Logistic Regression", "Decision Trees", "Apriori"],
        answer: 0
      }
    ],

    // -------------------------
    // MODULE 2 (FULL, CLEAN)
    // -------------------------
    2: [
      {
        question: "What is the primary goal of a cost function in machine learning?",
        options: [
          "To minimize the error",
          "To maximize the error",
          "To reduce the number of features",
          "To increase the complexity of the model"
        ],
        answer: 0
      },
      {
        question: "Which of the following is NOT a step in preparing data for ML algorithms?",
        options: ["Conducting feature selection", "Cleaning the data", "Visualizing the data", "Scaling the features"],
        answer: 2
      },
      {
        question: "Why do we create a test set?",
        options: ["To tune hyperparameters", "To train the model", "To estimate generalization error", "To validate the model"],
        answer: 2
      },
      {
        question: "Which is a common regression metric?",
        options: ["Precision", "RMSE", "Accuracy", "Recall"],
        answer: 1
      },
      {
        question: "Which is NOT an open data repository?",
        options: ["UCI ML Repo", "Kaggle", "Quandl", "Netflix Dataset"],
        answer: 3
      },
      {
        question: "What is the first step in working with real data?",
        options: ["Get the data", "Explore the data", "Frame the problem", "Fine-tune models"],
        answer: 2
      },
      {
        question: "Where did the California housing dataset come from?",
        options: ["UCI Repo", "StatLib", "Kaggle", "Quandl"],
        answer: 1
      },
      {
        question: "What is the smallest census geographic unit?",
        options: ["County", "City", "Block group", "Neighborhood"],
        answer: 2
      },
      {
        question: "Predicting median housing price is what task?",
        options: ["Classification", "Clustering", "Regression", "Association"],
        answer: 2
      },
      {
        question: "Why is RMSE preferred?",
        options: ["Easy to calculate", "Weights all errors equally", "Penalizes large errors", "Penalizes small errors"],
        answer: 2
      },

      {
        question: "First step in data acquisition?",
        options: ["Get the data", "Create a test set", "List needed data", "Document sources"],
        answer: 2
      },
      {
        question: "Which is NOT recommended during data prep?",
        options: ["Copy data", "Fill missing values", "Drop useless attributes", "Create test set after prep"],
        answer: 3
      },
      {
        question: "Why package transformations as functions?",
        options: ["Faster", "Apply once", "Reproducibility", "Less memory"],
        answer: 2
      },
      {
        question: "Why automate dataset downloading?",
        options: ["Faster training", "Correct format", "Reproducibility", "Reduce file size"],
        answer: 2
      },
      {
        question: "Why create a test set early?",
        options: ["Reduce size", "Avoid data snooping bias", "Improve accuracy", "Easier manipulation"],
        answer: 1
      },
      {
        question: "First step exploring data?",
        options: ["Visualize", "Clean", "Create functions", "Convert formats"],
        answer: 0
      },
      {
        question: "Advantage of Mini-batch GD?",
        options: [
          "Uses fewer samples",
          "Balances batch + SGD",
          "Has zero noise",
          "Faster than SGD"
        ],
        answer: 1
      },
      {
        question: "Which GD uses one sample at a time?",
        options: ["Batch", "Mini-batch", "SGD", "Polynomial GD"],
        answer: 2
      },
      {
        question: "Advantage of Batch GD?",
        options: ["Small samples", "Faster", "Converges to global min (convex)", "No gradient needed"],
        answer: 2
      },
      {
        question: "Main objective of Gradient Descent?",
        options: ["Maximize function", "Minimize function", "Find max cost", "Random updates"],
        answer: 1
      },

      {
        question: "Which OLS assumption means constant variance?",
        options: ["Independence", "Homoscedasticity", "Multicollinearity", "Linearity"],
        answer: 1
      },
      {
        question: "OLS minimizes:",
        options: [
          "Squared difference between observed & predicted",
          "Absolute difference",
          "Prediction probability",
          "Class margin"
        ],
        answer: 0
      },
      {
        question: "Hinge loss is used in:",
        options: ["Regression", "SVM", "Neural networks", "Decision trees"],
        answer: 1
      },
      {
        question: "MSE measures:",
        options: [
          "Absolute difference",
          "Average squared difference",
          "Product of values",
          "Ratio of values"
        ],
        answer: 1
      },
      {
        question: "Why is MAE less sensitive to outliers?",
        options: ["Squares errors", "Uses logs", "Uses absolute difference", "Only positive values"],
        answer: 2
      },
      {
        question: "Cross-entropy loss is used for:",
        options: ["Regression", "Classification", "Clustering", "Dimensionality reduction"],
        answer: 1
      },
      {
        question: "Minimizing the cost function:",
        options: ["Decreases complexity", "Worsens accuracy", "Improves accuracy", "Makes model unstable"],
        answer: 2
      },
      {
        question: "Predicting housing prices is:",
        options: ["Classification", "Clustering", "Regression", "Reinforcement"],
        answer: 2
      },
      {
        question: "Before visualizing data, you must:",
        options: ["Build model", "Select features", "Create test set", "Tune parameters"],
        answer: 2
      },
      {
        question: "Function to fit linear regression in sklearn?",
        options: ["model.train()", "model.fit()", "model.learn()", "model.optimize()"],
        answer: 1
      },
      {
        question: "Data snooping bias is:",
        options: [
          "Bias from small data",
          "Training using test data",
          "Overfitting from big data",
          "Noisy labels"
        ],
        answer: 1
      },
      {
        question: "Feature scaling happens in:",
        options: ["Model evaluation", "Data preparation", "Problem framing", "Model tuning"],
        answer: 1
      },
      {
        question: "OLS always:",
        options: [
          "Maximizes variance",
          "Minimizes squared error",
          "Ensures independence",
          "Prevents overfitting"
        ],
        answer: 1
      },
      {
        question: "A hyperplane in regression is:",
        options: [
          "Residual plot",
          "Feature transformation",
          "Linear prediction surface",
          "Error-reduction constraint"
        ],
        answer: 2
      },
      {
        question: "Advantage of mini-batch GD:",
        options: [
          "Faster convergence",
          "Balanced efficiency + noise reduction",
          "Eliminates local minima",
          "Improves RÂ²"
        ],
        answer: 1
      }
    ]
  },

  // OTHER COURSES
  "Data Mining": {
    1: [{ question: "DM Module 1 Q1?", options: ["A", "B", "C"], answer: 1 }]
  },

  "Decision Support Systems": {
    1: [{ question: "DSS Module 1 Q1?", options: ["A", "B", "C"], answer: 0 }]
  },

  "Data Security and Privacy": {
    1: [{ question: "DSP Module 1 Q1?", options: ["A", "B", "C"], answer: 2 }]
  },

  "Computer Vision": {
    1: [{ question: "CV Module 1 Q1?", options: ["A", "B", "C"], answer: 1 }]
  }
};


/* ----------------------------
LOAD QUESTIONS BASED ON MODE
---------------------------- */
let questions = [];

if (examMode === "true") {
    document.getElementById("moduleTitle").innerText = "Final Exam";
    document.getElementById("timer").style.display = "block";

    // combine all modules of the selected course (choice A)
    if (allQuestions[course]) {
        for (let mod in allQuestions[course]) {
            questions = questions.concat(allQuestions[course][mod]);
        }
    } else {
        questions = [];
    }

} else {
    document.getElementById("moduleTitle").innerText = "Module " + moduleNum;
    if (allQuestions[course] && allQuestions[course][moduleNum]) {
        questions = allQuestions[course][moduleNum];
    } else {
        questions = [];
    }
}

// handle empty question case
if (!questions || questions.length === 0) {
    document.getElementById("quizBox").innerHTML = `
      <div class="empty-message">
        No questions available for this course/module. <br><br>
        <button onclick="location.href='modules.html'">Back to Modules</button>
      </div>`;
    throw new Error("No questions found for course/module");
}

// shuffle questions
questions = questions.sort(() => Math.random() - 0.5);

let index = 0;
let score = 0;
let answered = false;
let answersHistory = [];

/* ----------------------------
TIMER FOR EXAM MODE
---------------------------- */
let totalTime = 300;
let timerInterval;

function startTimer() {
    // only start if examMode & questions exist
    if (examMode !== "true" || !questions.length) return;
    timerInterval = setInterval(() => {
        totalTime--;
        let m = Math.floor(totalTime / 60);
        let s = totalTime % 60;
        if (s < 10) s = "0" + s;

        document.getElementById("timer").innerText = `Time Left: ${m}:${s}`;

        if (totalTime <= 0) finishQuizDueToTime();
    }, 1000);
}

/* ----------------------------
DISPLAY QUESTION
---------------------------- */
function loadQuestion() {
    answered = false;

    // Start timer only once & only in exam mode
    if (index === 0 && examMode === "true") startTimer();

    // Progress bar update
    let progress = (index / questions.length) * 100;
    document.getElementById("progressBar").style.width = progress + "%";

    const q = questions[index];

    document.getElementById("questionNumber").innerText =
        "Question " + (index + 1) + " / " + questions.length;

    document.getElementById("questionText").innerText = q.question || "";

    const answersDiv = document.getElementById("answers");
    answersDiv.innerHTML = "";

    (q.options || []).forEach((opt, i) => {
        answersDiv.innerHTML += `
        <div class="answer" onclick="selectAnswer(${i}, this)">
            ${opt}
        </div>`;
    });

    document.getElementById("nextBtn").style.display = "none";
    document.getElementById("backBtn").style.display = index > 0 ? "block" : "none";
}

/* ----------------------------
SELECT ANSWER
---------------------------- */
function selectAnswer(selectedIndex, element) {
    if (answered) return;
    answered = true;

    const correctIndex = questions[index].answer;
    const options = document.querySelectorAll(".answer");

    answersHistory[index] = selectedIndex;

    // mark correct
    if (typeof correctIndex === "number" && options[correctIndex]) {
        options[correctIndex].classList.add("correct");
    }

    if (selectedIndex !== correctIndex) {
        element.classList.add("wrong");
    } else score++;

    options.forEach(opt => opt.classList.add("disabled"));

    document.getElementById("nextBtn").style.display = "block";
}

/* ----------------------------
NEXT QUESTION
---------------------------- */
function nextQuestion() {
    index++;

    if (index === questions.length) {
        clearInterval(timerInterval);
        finishQuiz();
    } else {
        loadQuestion();
    }
}

function finishQuiz() {
    localStorage.setItem("score", score);
    localStorage.setItem("reviewQuestions", JSON.stringify(questions));
    localStorage.setItem("reviewAnswers", JSON.stringify(answersHistory));
    window.location.href = "result.html";
}

function finishQuizDueToTime() {
    clearInterval(timerInterval);
    localStorage.setItem("timeUp", "yes");
    finishQuiz();
}

/* ----------------------------
BACK BUTTON
---------------------------- */
function prevQuestion() {
    if (index === 0) return;

    index--;
    loadQuestion();

    let prev = answersHistory[index];
    if (prev !== undefined && prev !== null) {
        const options = document.querySelectorAll(".answer");

        options.forEach(opt => opt.classList.add("disabled"));

        if (prev === questions[index].answer) {
            options[prev].classList.add("correct");
        } else {
            options[prev].classList.add("wrong");
            if (options[questions[index].answer]) {
                options[questions[index].answer].classList.add("correct");
            }
        }

        answered = true;
        document.getElementById("nextBtn").style.display = "block";
    }

    document.getElementById("backBtn").style.display = index > 0 ? "block" : "none";
}

/* ----------------------------
INITIAL LOAD
---------------------------- */
loadQuestion();
</script>

</body>
</html>




