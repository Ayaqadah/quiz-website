<!DOCTYPE html>
<html>
<head>
<title>Quiz ðŸŒ¿</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
body {
    font-family: "Poppins", sans-serif;
    background: linear-gradient(135deg, #f3f7f4, #e1ece4);
    padding: 40px 15px;
    max-width: 900px;
    margin: auto;
    color: #2F3E34;
    animation: fadeIn 0.6s ease-out;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* Main Card */
#quizBox {
    background: white;
    padding: 35px;
    border-radius: 25px;
    box-shadow: 0px 8px 25px rgba(0,0,0,0.07);
    width: 100%;
}

/* Titles */
h2 {
    color: #7AA78B;
    font-weight: 600;
    margin-bottom: 8px;
}

#moduleTitle {
    margin-bottom: 20px;
    font-size: 20px;
}

/* Progress Bar */
#progressContainer {
    width:100%;
    background:#e5efe7;
    border-radius:20px;
    height:18px;
    margin-bottom:20px;
    overflow:hidden;
}

#progressBar {
    height:100%;
    width:0%;
    background:#8EB897;
    border-radius:20px;
    transition:0.4s;
}

/* Timer */
#timer {
    text-align:right;
    color:#7AA78B;
    font-weight:600;
    display:none;
    font-size: 20px;
}

/* Question text */
#questionText {
    font-size: 20px;
    margin-bottom: 15px;
}

/* Answer options */
.answer {
    background: #F2F5F1;
    padding: 14px 18px;
    border-radius: 15px;
    margin: 10px 0;
    cursor: pointer;
    transition: 0.25s;
    border: 1px solid #DCE7D7;
    font-size: 17px;
}

.answer:hover {
    background: #E7F0E4;
}

.correct {
    background: #CFF5D1 !important;
    border: 2px solid #4CAF50;
}

.wrong {
    background: #F5D3D3 !important;
    border: 2px solid #E15858;
}

.disabled {
    pointer-events: none;
    opacity: 0.7;
}

/* Navigation buttons */
button {
    padding: 12px 30px;
    background: #8EB897;
    color: white;
    border: none;
    border-radius: 18px;
    font-size: 17px;
    cursor: pointer;
    transition: 0.3s;
}

button:hover {
    background: #7AA78B;
}

#backBtn {
    background: #A6C8B2;
}

#backBtn:hover {
    background: #95B7A2;
}

/* Empty state */
.empty-message {
    padding: 25px;
    text-align: center;
    color: #6b7c6f;
    font-size: 18px;
}
</style>
</head>

<body>

<div id="quizBox">

    <!-- Progress bar -->
    <div id="progressContainer">
        <div id="progressBar"></div>
    </div>

    <!-- Timer (hidden unless exam mode) -->
    <h2 id="timer">Time Left: 05:00</h2>

    <h2 id="courseTitle"></h2>
    <h3 id="moduleTitle"></h3>

    <h2 id="questionNumber"></h2>
    <p id="questionText"></p>

    <div id="answers"></div>

    <div style="display:flex; justify-content:space-between; margin-top:25px;">
        <button id="backBtn" onclick="prevQuestion()" style="display:none;">â¬… Back</button>
        <button id="nextBtn" onclick="nextQuestion()">Next âžœ</button>
    </div>
</div>

<script>
/* ----------------------------
Load saved course/module info
---------------------------- */
let course = localStorage.getItem("selectedCourse");
let moduleNum = localStorage.getItem("selectedModule");
let examMode = localStorage.getItem("examMode");

if (!course) {
    // If somehow the course isn't set, send user back to courses
    document.getElementById("quizBox").innerHTML = `
      <div class="empty-message">
        No course selected. <br><br>
        <button onclick="location.href='courses.html'">Back to Courses</button>
      </div>`;
    throw new Error("No course selected");
}

document.getElementById("courseTitle").innerText = course;

/* -----------------------------
QUESTION BANK (correctly defined)
---------------------------- */
let allQuestions = {
  "Machine Learning": {
    1: [
      {
        question: "How does Arthur Samuel define Machine Learning?",
        options: [
          "A computer's ability to learn through trial and error",
          "The ability to learn without being explicitly programmed",
          "Learning from a set of labeled data points",
          "Using statistical models to predict outcomes"
        ],
        answer: 1
      },

      {
        question: "According to Tom Mitchell, when can a computer program be said to learn from experience?",
        options: [
          "When it can generalize from one task to another",
          "When it improves performance on task T after experience E, as measured by performance measure P",
          "When it can memorize data sets",
          "When it can classify data without supervision"
        ],
        answer: 1
      },

      {
        question: "In traditional programming, how would you typically write a spam filter?",
        options: [
          "By analyzing a dataset of spam messages",
          "By creating detection algorithms for specific patterns like words or phrases",
          "By using reinforcement learning techniques",
          "By running a pre-trained algorithm"
        ],
        answer: 1
      },

      {
        question: "How does a spam filter based on Machine Learning detect spam?",
        options: [
          "By learning which words and phrases are predictors of spam through historical examples",
          "By memorizing past emails",
          "By using a pre-programmed rule-based system",
          "By randomly flagging emails"
        ],
        answer: 0
      },

      {
        question: "What is an additional benefit of Machine Learning beyond filtering spam?",
        options: [
          "It can help humans discover patterns in large datasets that were not previously apparent",
          "It replaces the need for human intuition in decision-making",
          "It eliminates the need for supervision in data analysis",
          "It can only handle specific, well-known problems"
        ],
        answer: 0
      },

      {
        question: "What does supervised learning involve?",
        options: [
          "Using labeled training data to learn from historical examples",
          "Classifying data without any labels",
          "Building an algorithm without training data",
          "Comparing new data points to old ones"
        ],
        answer: 0
      },

      {
        question: "Which of the following is an example of a supervised learning task?",
        options: [
          "Clustering data into groups",
          "Predicting the price of a car based on its mileage, brand, and age",
          "Reducing the dimensionality of a dataset",
          "Discovering patterns in unlabeled data"
        ],
        answer: 1
      },

      {
        question: "Which of the following is a task commonly associated with supervised learning?",
        options: [
          "Clustering",
          "Classification",
          "Dimensionality reduction",
          "Data mining"
        ],
        answer: 1
      },

      {
        question: "Predicting a numeric value like car price is an example of:",
        options: [
          "Classification",
          "Clustering",
          "Regression",
          "Dimensionality reduction"
        ],
        answer: 2
      },

      {
        question: "Which of the following are examples of supervised learning algorithms?",
        options: [
          "K-means and DBSCAN",
          "Neural networks and Decision Trees",
          "Association rule learning and Clustering",
          "Autoencoders and Isolation Forest"
        ],
        answer: 1
      },

      {
        question: "What distinguishes unsupervised learning from supervised learning?",
        options: [
          "The training data in unsupervised learning is unlabeled",
          "Unsupervised learning requires more training data",
          "Unsupervised learning algorithms always outperform supervised learning",
          "Unsupervised learning focuses on regression tasks"
        ],
        answer: 0
      },

      {
        question: "Which of the following is an example of an unsupervised learning algorithm?",
        options: [
          "K-means",
          "Logistic regression",
          "Neural networks",
          "Random forests"
        ],
        answer: 0
      },

      {
        question: "What is the goal of clustering in unsupervised learning?",
        options: [
          "To discover groups of related observations within the data",
          "To predict numeric values based on labeled data",
          "To classify data into predefined categories",
          "To reduce the dimensionality of the data"
        ],
        answer: 0
      },

      {
        question: "Which algorithms are used for anomaly detection in unsupervised learning?",
        options: [
          "One-class SVM and Isolation Forest",
          "K-nearest neighbors and Logistic Regression",
          "Decision Trees and Support Vector Machines",
          "Apriori and Eclat"
        ],
        answer: 0
      },

      {
        question: "What is semi-supervised learning?",
        options: [
          "Learning without any labeled data",
          "Learning with a small amount of labeled data and a large amount of unlabeled data",
          "A combination of unsupervised and reinforcement learning",
          "Learning exclusively through rewards and penalties"
        ],
        answer: 1
      },

      {
        question: "What does the learning system observe in Reinforcement Learning?",
        options: [
          "Labeled data points",
          "Patterns in training data",
          "The environment, actions, and rewards",
          "Clusters of similar data points"
        ],
        answer: 2
      },

      {
        question: "In Reinforcement Learning, what is the system referred to as?",
        options: [
          "A predictor",
          "A classifier",
          "An agent",
          "A cluster"
        ],
        answer: 2
      },

      {
        question: "What are two major things that can go wrong in a Machine Learning project?",
        options: [
          "Choosing the wrong dataset and using too many features",
          "Collecting bad data and selecting a poor learning algorithm",
          "Choosing too many hyperparameters and failing to overfit",
          "Using too few training examples and clustering incorrectly"
        ],
        answer: 1
      },

      {
        question: "What problem arises from a non-representative training sample?",
        options: [
          "It leads to overfitting",
          "It affects the generalization of the model",
          "It helps improve prediction accuracy",
          "It indicates a well-trained model"
        ],
        answer: 1
      },

      {
        question: "What is underfitting?",
        options: [
          "When the model fails to capture the noise in training data",
          "When the model is too simple to capture the structure of the data",
          "When the model performs better on training than test data",
          "When the model uses too many features"
        ],
        answer: 1
      },

      {
        question: "What is Machine Learning (ML)?",
        options: [
          "Writing explicit programs to handle specific tasks",
          "A field that enables computers to learn without explicit programming",
          "Using data to perform calculations",
          "A method for storing large datasets"
        ],
        answer: 1
      },

      {
        question: "What are the three main types of Machine Learning?",
        options: [
          "Regression, classification, clustering",
          "Supervised, unsupervised, reinforcement learning",
          "Supervised, clustering, prediction",
          "Neural networks, decision trees, clustering"
        ],
        answer: 1
      },

      {
        question: "Which ML type uses labeled data?",
        options: [
          "Unsupervised learning",
          "Supervised learning",
          "Reinforcement learning",
          "Semi-supervised learning"
        ],
        answer: 1
      },

      {
        question: "What is the main goal of unsupervised learning?",
        options: [
          "Predicting target values",
          "Finding patterns in unlabeled data",
          "Minimizing bias and variance",
          "Performing regression tasks"
        ],
        answer: 1
      },

      {
        question: "What is reinforcement learning based on?",
        options: [
          "Training with labeled data",
          "Clustering data points",
          "Receiving rewards or penalties for actions",
          "Reducing dimensionality"
        ],
        answer: 2
      },

      {
        question: "Which of the following is a supervised learning task?",
        options: [
          "Clustering",
          "Dimensionality reduction",
          "Regression",
          "Association rule learning"
        ],
        answer: 2
      },

      {
        question: "What is overfitting in ML?",
        options: [
          "When a model performs well on training data but poorly on unseen data",
          "When the model cannot capture training data patterns",
          "When the training dataset is too small",
          "When a model uses too few parameters"
        ],
        answer: 0
      },

      {
        question: "What is underfitting?",
        options: [
          "When a model has low bias",
          "When a model is too simple to capture patterns",
          "When a model has high variance",
          "When a model uses too many parameters"
        ],
        answer: 1
      },

      {
        question: "What is the purpose of a validation set?",
        options: [
          "Training the model",
          "Tuning hyperparameters",
          "Testing final performance",
          "Detecting overfitting"
        ],
        answer: 1
      },

      {
        question: "What is cross-validation?",
        options: [
          "Splitting data into labeled and unlabeled sets",
          "A technique for training and validating a model on multiple partitions",
          "Evaluating a model using only a training set",
          "Using unlabeled data to fine-tune models"
        ],
        answer: 1
      },

      {
        question: "What does the bias-variance trade-off refer to?",
        options: [
          "Increasing both bias and variance",
          "Reducing error to zero",
          "Balancing bias and variance to optimize performance",
          "Removing noise from data"
        ],
        answer: 2
      },

      {
        question: "What is a common unsupervised learning task?",
        options: [
          "Regression",
          "Classification",
          "Clustering",
          "Reinforcement learning"
        ],
        answer: 2
      },

      {
        question: "Which of the following is an example of dimensionality reduction?",
        options: [
          "Regression",
          "Clustering",
          "Principal Component Analysis (PCA)",
          "Reinforcement learning"
        ],
        answer: 2
      },

      {
        question: "How is accuracy calculated in classification tasks?",
        options: [
          "(TP + TN) / (TP + TN + FP + FN)",
          "TP / (TP + FN)",
          "TN / (TN + FP)",
          "FP / (FP + FN)"
        ],
        answer: 0
      },

      {
        question: "What is precision in classification tasks?",
        options: [
          "The fraction of true positives out of all predicted positives",
          "The fraction of true positives out of all actual positives",
          "The proportion of true negatives",
          "The total prediction error"
        ],
        answer: 0
      }

    ], // end ML module 1 array
    2: [
  {
    question: "What is the primary goal of a cost function in machine learning?",
    options: [
      "To minimize the error",
      "To maximize the error",
      "To reduce the number of features",
      "To increase the complexity of the model"
    ],
    answer: 0
  },

  {
    question: "Which of the following is NOT a step in preparing data for machine learning algorithms?",
    options: [
      "Conducting feature selection",
      "Cleaning the data",
      "Visualizing the data",
      "Scaling the features"
    ],
    answer: 2
  },

  {
    question: "What is the purpose of creating a test set in machine learning?",
    options: [
      "To optimize hyper-parameters",
      "To train the model",
      "To estimate the generalization error",
      "To validate the model"
    ],
    answer: 2
  },

  {
    question: "Which of the following is a common performance measure for regression problems?",
    options: [
      "Precision",
      "Root Mean Squared Error (RMSE)",
      "Accuracy",
      "Recall"
    ],
    answer: 1
  },

  {
    question: "Which of the following is NOT listed as a popular open data repository?",
    options: [
      "UCI Irvine Machine Learning Repository",
      "Kaggle datasets",
      "Quandl",
      "Netflix Dataset"
    ],
    answer: 3
  },

  {
    question: "What is the first step in working with real data?",
    options: [
      "Get the data",
      "Explore the data",
      "Frame the problem and look at the big picture",
      "Fine-tune your models"
    ],
    answer: 2
  },

  {
    question: "What is the source of the dataset used in the example for California housing prices?",
    options: [
      "UCI Irvine Machine Learning Repository",
      "StatLib repository",
      "Kaggle datasets",
      "Quandl"
    ],
    answer: 1
  },

  {
    question: "What is the smallest geographical unit for which census data is published in the California housing dataset?",
    options: [
      "County",
      "City",
      "Block group",
      "Neighborhood"
    ],
    answer: 2
  },

  {
    question: "What type of task is used to predict the median housing price in a district?",
    options: [
      "Classification task",
      "Clustering task",
      "Regression task",
      "Association task"
    ],
    answer: 2
  },

  {
    question: "Why is Root Mean Squared Error (RMSE) often preferred for regression problems?",
    options: [
      "It is easier to calculate",
      "It gives equal weight to all errors",
      "It gives a higher weight to large errors",
      "It gives a higher weight to small errors"
    ],
    answer: 2
  },

  {
    question: "In the data acquisition step, what is the first action to take?",
    options: [
      "Get the data",
      "Create a test set",
      "List the data needed and how much",
      "Document where to get the data"
    ],
    answer: 2
  },

  {
    question: "When preparing data, which of the following is NOT a recommended step?",
    options: [
      "Creating a copy of the data",
      "Filling missing values with the mean",
      "Dropping attributes that provide no useful information",
      "Creating a test set before data preparation"
    ],
    answer: 3
  },

  {
    question: "Why is it important to package data transformations as functions?",
    options: [
      "To make the code run faster",
      "To apply transformations only once",
      "For reproducibility on test and production data",
      "To reduce memory usage"
    ],
    answer: 2
  },

  {
    question: "What is the purpose of creating utility functions to automate downloading datasets?",
    options: [
      "To make it faster to train models",
      "To ensure data is in the correct format",
      "To automate repetitive tasks and make the process reproducible",
      "To reduce the file size"
    ],
    answer: 2
  },

  {
    question: "Why is it important to create a test set before looking at the data?",
    options: [
      "To reduce data size",
      "To avoid data snooping bias",
      "To improve model accuracy",
      "To make the data easier to manipulate"
    ],
    answer: 1
  },

  {
    question: "What is one of the first steps when exploring a dataset for insights?",
    options: [
      "Visualize the data",
      "Clean the data",
      "Create utility functions",
      "Convert data into a usable format"
    ],
    answer: 0
  },

  {
    question: "What is a key advantage of Mini-batch Gradient Descent?",
    options: [
      "It uses fewer samples than SGD",
      "It balances the trade-off between batch and stochastic methods",
      "It avoids any noise in gradient updates",
      "It is faster than stochastic methods"
    ],
    answer: 1
  },

  {
    question: "Which type of Gradient Descent uses one sample at a time to compute the gradient?",
    options: [
      "Batch Gradient Descent",
      "Mini-batch Gradient Descent",
      "Stochastic Gradient Descent (SGD)",
      "Polynomial Gradient Descent"
    ],
    answer: 2
  },

  {
    question: "What is one advantage of Batch Gradient Descent?",
    options: [
      "It uses a small sample for computation",
      "It converges faster than other methods",
      "It always converges to the global minimum for convex functions",
      "It avoids the need for gradient calculation"
    ],
    answer: 2
  },

  {
    question: "What is the main objective of Gradient Descent?",
    options: [
      "To maximize a function by adjusting its parameters",
      "To minimize a function by adjusting its parameters",
      "To find the maximum value of a cost function",
      "To make random parameter updates"
    ],
    answer: 1
  },

  {
    question: "Which assumption of Ordinary Least Squares (OLS) ensures that error terms have constant variance?",
    options: [
      "Independence",
      "Homoscedasticity",
      "Multicollinearity",
      "Linearity"
    ],
    answer: 1
  },

  {
    question: "What does Ordinary Least Squares (OLS) aim to minimize?",
    options: [
      "The sum of squared differences between observed and predicted values",
      "The absolute difference between observed and predicted values",
      "The probability of prediction",
      "The margin between classes"
    ],
    answer: 0
  },

  {
    question: "In what kind of machine learning task is Hinge Loss primarily used?",
    options: [
      "Regression tasks",
      "Support vector machines (SVM)",
      "Neural networks",
      "Decision trees"
    ],
    answer: 1
  },

  {
    question: "What does the Mean Squared Error (MSE) measure?",
    options: [
      "The absolute difference between actual and predicted values",
      "The average squared difference between actual and predicted values",
      "The product of actual and predicted values",
      "The ratio of actual to predicted values"
    ],
    answer: 1
  },

  {
    question: "Why is Mean Absolute Error (MAE) less sensitive to outliers compared to MSE?",
    options: [
      "Because it squares the errors",
      "Because it uses logarithmic scaling",
      "Because it measures the absolute difference",
      "Because it only measures positive values"
    ],
    answer: 2
  },

  {
    question: "What is Cross-Entropy Loss used for?",
    options: [
      "Regression problems",
      "Classification problems",
      "Clustering problems",
      "Dimensionality reduction"
    ],
    answer: 1
  },

  {
    question: "How does minimizing the cost function affect a machine learning model?",
    options: [
      "It decreases the modelâ€™s complexity",
      "It worsens model accuracy",
      "It improves the modelâ€™s accuracy",
      "It makes the model unstable"
    ],
    answer: 2
  },

  {
    question: "Which type of Gradient Descent uses one sample at a time to compute the gradient?",
    options: [
      "Batch Gradient Descent",
      "Mini-batch Gradient Descent",
      "Stochastic Gradient Descent (SGD)",
      "Polynomial Gradient Descent"
    ],
    answer: 2
  },

  {
    question: "Predicting housing prices based on income and population is an example of:",
    options: [
      "Classification",
      "Clustering",
      "Regression",
      "Reinforcement learning"
    ],
    answer: 2
  },

  {
    question: "What should be done before visualizing and analyzing data in a machine learning project?",
    options: [
      "Build the model",
      "Select features",
      "Create a test set",
      "Fine-tune hyperparameters"
    ],
    answer: 2
  },

  {
    question: "Which function in Scikit-learn is used to fit a linear regression model?",
    options: [
      "model.train()",
      "model.fit()",
      "model.learn()",
      "model.optimize()"
    ],
    answer: 1
  },

  {
    question: "What is data snooping bias?",
    options: [
      "Bias caused by insufficient data",
      "Bias introduced by using test data during training",
      "Overfitting caused by large datasets",
      "Bias from noisy labels in training data"
    ],
    answer: 1
  },

  {
    question: "Which step in an end-to-end ML project involves feature scaling?",
    options: [
      "Model evaluation",
      "Data preparation",
      "Problem framing",
      "Model fine-tuning"
    ],
    answer: 1
  },

  {
    question: "Which of the following is true about ordinary least squares (OLS)?",
    options: [
      "It maximizes the variance in data",
      "It minimizes the sum of squared differences between actual and predicted values",
      "It ensures independence between features",
      "It prevents overfitting in models"
    ],
    answer: 1
  },

  {
    question: "What is a hyperplane in linear regression?",
    options: [
      "A multidimensional plot of residuals",
      "A transformation of input features",
      "A linear surface that represents the model's predictions",
      "A constraint for reducing errors"
    ],
    answer: 2
  },

  {
    question: "What is the advantage of using mini-batch gradient descent over batch gradient descent?",
    options: [
      "Ensures faster convergence",
      "Balances computational efficiency and noise reduction",
      "Eliminates local minima",
      "Improves R-squared scores"
    ],
    answer: 1
  }
];

  "Data Mining": {
    1: [{ question: "DM Module 1 Q1?", options: ["A", "B", "C"], answer: 1 }]
  },

  "Decision Support Systems": {
    1: [{ question: "DSS Module 1 Q1?", options: ["A", "B", "C"], answer: 0 }]
  },

  "Data Security and Privacy": {
    1: [{ question: "DSP Module 1 Q1?", options: ["A", "B", "C"], answer: 2 }]
  },

  "Computer Vision": {
    1: [{ question: "CV Module 1 Q1?", options: ["A", "B", "C"], answer: 1 }]
  }

}; // end allQuestions

/* ----------------------------
LOAD QUESTIONS BASED ON MODE
---------------------------- */
let questions = [];

if (examMode === "true") {
    document.getElementById("moduleTitle").innerText = "Final Exam";
    document.getElementById("timer").style.display = "block";

    // combine all modules of the selected course (choice A)
    if (allQuestions[course]) {
        for (let mod in allQuestions[course]) {
            questions = questions.concat(allQuestions[course][mod]);
        }
    } else {
        questions = [];
    }

} else {
    document.getElementById("moduleTitle").innerText = "Module " + moduleNum;
    if (allQuestions[course] && allQuestions[course][moduleNum]) {
        questions = allQuestions[course][moduleNum];
    } else {
        questions = [];
    }
}

// handle empty question case
if (!questions || questions.length === 0) {
    document.getElementById("quizBox").innerHTML = `
      <div class="empty-message">
        No questions available for this course/module. <br><br>
        <button onclick="location.href='modules.html'">Back to Modules</button>
      </div>`;
    throw new Error("No questions found for course/module");
}

// shuffle questions
questions = questions.sort(() => Math.random() - 0.5);

let index = 0;
let score = 0;
let answered = false;
let answersHistory = [];

/* ----------------------------
TIMER FOR EXAM MODE
---------------------------- */
let totalTime = 300;
let timerInterval;

function startTimer() {
    // only start if examMode & questions exist
    if (examMode !== "true" || !questions.length) return;
    timerInterval = setInterval(() => {
        totalTime--;
        let m = Math.floor(totalTime / 60);
        let s = totalTime % 60;
        if (s < 10) s = "0" + s;

        document.getElementById("timer").innerText = `Time Left: ${m}:${s}`;

        if (totalTime <= 0) finishQuizDueToTime();
    }, 1000);
}

/* ----------------------------
DISPLAY QUESTION
---------------------------- */
function loadQuestion() {
    answered = false;

    // Start timer only once & only in exam mode
    if (index === 0 && examMode === "true") startTimer();

    // Progress bar update
    let progress = (index / questions.length) * 100;
    document.getElementById("progressBar").style.width = progress + "%";

    const q = questions[index];

    document.getElementById("questionNumber").innerText =
        "Question " + (index + 1) + " / " + questions.length;

    document.getElementById("questionText").innerText = q.question || "";

    const answersDiv = document.getElementById("answers");
    answersDiv.innerHTML = "";

    (q.options || []).forEach((opt, i) => {
        answersDiv.innerHTML += `
        <div class="answer" onclick="selectAnswer(${i}, this)">
            ${opt}
        </div>`;
    });

    document.getElementById("nextBtn").style.display = "none";
    document.getElementById("backBtn").style.display = index > 0 ? "block" : "none";
}

/* ----------------------------
SELECT ANSWER
---------------------------- */
function selectAnswer(selectedIndex, element) {
    if (answered) return;
    answered = true;

    const correctIndex = questions[index].answer;
    const options = document.querySelectorAll(".answer");

    answersHistory[index] = selectedIndex;

    // mark correct
    if (typeof correctIndex === "number" && options[correctIndex]) {
        options[correctIndex].classList.add("correct");
    }

    if (selectedIndex !== correctIndex) {
        element.classList.add("wrong");
    } else score++;

    options.forEach(opt => opt.classList.add("disabled"));

    document.getElementById("nextBtn").style.display = "block";
}

/* ----------------------------
NEXT QUESTION
---------------------------- */
function nextQuestion() {
    index++;

    if (index === questions.length) {
        clearInterval(timerInterval);
        finishQuiz();
    } else {
        loadQuestion();
    }
}

function finishQuiz() {
    localStorage.setItem("score", score);
    localStorage.setItem("reviewQuestions", JSON.stringify(questions));
    localStorage.setItem("reviewAnswers", JSON.stringify(answersHistory));
    window.location.href = "result.html";
}

function finishQuizDueToTime() {
    clearInterval(timerInterval);
    localStorage.setItem("timeUp", "yes");
    finishQuiz();
}

/* ----------------------------
BACK BUTTON
---------------------------- */
function prevQuestion() {
    if (index === 0) return;

    index--;
    loadQuestion();

    let prev = answersHistory[index];
    if (prev !== undefined && prev !== null) {
        const options = document.querySelectorAll(".answer");

        options.forEach(opt => opt.classList.add("disabled"));

        if (prev === questions[index].answer) {
            options[prev].classList.add("correct");
        } else {
            options[prev].classList.add("wrong");
            if (options[questions[index].answer]) {
                options[questions[index].answer].classList.add("correct");
            }
        }

        answered = true;
        document.getElementById("nextBtn").style.display = "block";
    }

    document.getElementById("backBtn").style.display = index > 0 ? "block" : "none";
}

/* ----------------------------
INITIAL LOAD
---------------------------- */
loadQuestion();
</script>

</body>
</html>



